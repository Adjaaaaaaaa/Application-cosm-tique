{% extends 'base.html' %}
{% load static %}

{% comment %}
Template d'accueil BeautyScan avec design différencié et optimisé :
- Avant connexion : Style minimaliste inspiré des apps cosmétiques coréennes et Yuka (hero, avantages, mockup)
- Après connexion : Style Yuka (vert clair #A3D9A5)

Choix techniques :
- Variables CSS pour faciliter la maintenance des couleurs
- Classes spécifiques pour chaque état (connecté/non connecté)
- Structure responsive avec Bootstrap
- Animations subtiles pour améliorer l'UX
- Interface minimaliste avec cards arrondies et ombres douces
{% endcomment %}

{% block title %}BeautyScan - Analyse Cosmétique Intelligente{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/accounts/home.css' %}">
{% endblock %}

{% block content %}
{% comment %}
Section contenu principal avec logique conditionnelle :
- Affichage du message de downgrade si applicable
- Interface différenciée selon le statut d'authentification
- Structure modulaire pour faciliter la maintenance
{% endcomment %}

<!-- Message de succès pour le downgrade -->
{% if just_downgraded %}
<div class="container mt-4">
    <div class="alert alert-success alert-dismissible fade show" role="alert">
        <i class="fas fa-check-circle me-2"></i>
        <strong>Succès !</strong> {{ downgrade_message }}
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>
</div>
{% endif %}

{% if user.is_authenticated %}
    {% comment %}
    Interface pour utilisateurs connectés - Style Yuka
    Fonctionnalités : Accueil personnalisé, accès direct scanner et Premium
    {% endcomment %}
    <!-- Interface pour utilisateurs connectés -->
    <section class="welcome-section">
        <div class="container">
            <div class="welcome-card fade-in-up">
                <div class="welcome-avatar">
                    <i class="fas fa-user"></i>
                </div>
                <h1 class="welcome-title">
                    Bienvenue, {{ user.username }} !
                </h1>
                <p class="welcome-subtitle">
                    Prêt(e) à analyser vos produits de beauté ?
                </p>
            </div>
        </div>
    </section>

    <!-- Cartes d'action pour utilisateurs connectés -->
    <section class="action-cards">
        <div class="container">
            <div class="row">
                <!-- Carte Scanner -->
                <div class="col-lg-6 col-md-6">
                    <div class="action-card fade-in-up">
                        <div class="action-icon">
                            <i class="fas fa-barcode"></i>
                        </div>
                        <h3 class="action-title">Scanner un produit</h3>
                        <p class="action-description">
                            Analysez instantanément la composition de vos cosmétiques et découvrez leur niveau de sécurité.
                        </p>
                        <a href="{% url 'scans:demo_scan' %}" class="btn btn-primary-custom">
                            <i class="fas fa-search me-2"></i>Commencer l'analyse
                        </a>
                    </div>
                </div>

                <!-- Carte Premium -->
                <div class="col-lg-6 col-md-6">
                    <div class="action-card fade-in-up">
                        <div class="action-icon">
                            <i class="fas fa-crown"></i>
                        </div>
                        <h3 class="action-title">
                            {% if user.profile.is_premium %}
                                Mode Premium
                            {% else %}
                                Passer au Premium
                            {% endif %}
                        </h3>
                        <p class="action-description">
                            {% if user.profile.is_premium %}
                                Profitez de toutes les fonctionnalités avancées et de l'assistant IA personnalisé.
                            {% else %}
                                Débloquez l'assistant IA, les routines sur mesure et les analyses avancées.
                            {% endif %}
                        </p>
                        {% if user.profile.is_premium %}
                            <a href="{% url 'ai_routines:beauty_assistant' %}" class="btn btn-premium">
                                <i class="fas fa-robot me-2"></i>Interface IA Premium
                            </a>
                        {% else %}
                            <a href="{% url 'payments:subscription' %}" class="btn btn-premium">
                                <i class="fas fa-crown me-2"></i>Découvrir Premium
                            </a>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </section>

{% else %}
    {% comment %}
    Interface pour visiteurs non connectés - Style minimaliste cosmétique
    Fonctionnalités : Page d'accueil épurée avec hero, avantages, mockup téléphone
    Design : Style minimaliste avec cards arrondies, fond blanc, inspiré des apps cosmétiques coréennes et Yuka
    {% endcomment %}
    


         <!-- Hero Section - Logo centré + slogan + bouton -->
     <section class="hero-section">
         <div class="container">
             <div class="hero-content fade-in-up">
                 <div class="hero-block">
                    <div class="text-center mb-4">
                     
                        <img src="{% static 'images/logo.png' %}" alt="BeautyScan" class="hero-logo" style="display:block; margin:0 auto; max-width:200px; width:100%; height:auto;">

                </div>
                     <h1 class="hero-title">
                         Analysez vos cosmétiques en un scan
                     </h1>
                 </div>
             </div>
         </div>
     </section>

    <!-- Section mockup téléphone -->
    <section class="mockup-section">
        <div class="container">
            <div class="mockup-container">
                <p class="mockup-description">
                    Pointez votre caméra vers le code-barres de vos produits cosmétiques et obtenez instantanément une analyse détaillée de leur composition.
                </p>
                <div class="text-center">
                    <div class="mt-4">
                        <a href="{% url 'scans:demo_scan' %}" class="btn btn-primary-custom btn-lg">
                            <i class="fas fa-search me-2"></i>Scanner maintenant
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Section avantages - 3 cards alignées -->
    <section class="features-section">
        <div class="container">
            <div class="row">
                <div class="col-lg-4 col-md-6 mb-4">
                    <div class="feature-card fade-in-up">
                        <div class="feature-icon">
                            <i class="fas fa-bolt"></i>
                        </div>
                        <h3 class="feature-title">Analyse instantanée</h3>
                        <p class="feature-text">
                            Scannez le code-barres de vos produits et obtenez une analyse complète en quelques secondes
                        </p>
                    </div>
                </div>
                <div class="col-lg-4 col-md-6 mb-4">
                    <div class="feature-card fade-in-up">
                        <div class="feature-icon">
                            <i class="fas fa-user-check"></i>
                        </div>
                        <h3 class="feature-title">Recommandations personnalisées</h3>
                        <p class="feature-text">
                            Recevez des conseils adaptés à votre type de peau, âge et allergies spécifiques
                        </p>
                    </div>
                </div>
                <div class="col-lg-4 col-md-12 mb-4">
                    <div class="feature-card fade-in-up">
                        <div class="feature-icon">
                            <i class="fas fa-magic"></i>
                        </div>
                        <h3 class="feature-title">Routines beauté adaptées</h3>
                        <p class="feature-text">
                            Créez des routines personnalisées avec des produits sûrs et efficaces pour votre peau
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </section>



{% endif %}

{% endblock %}

{% block extra_js %}
<script>
/**
 * Script principal pour la page d'accueil BeautyScan
 * 
 * Fonctionnalités :
 * - Navigation fluide pour les liens d'ancre
 * - Gestion des messages de downgrade Premium
 * - Animations d'apparition des éléments
 * 
 * Choix techniques :
 * - Utilisation de l'événement DOMContentLoaded pour s'assurer que le DOM est chargé
 * - Gestion gracieuse des erreurs avec try-catch implicite
 * - Code modulaire et réutilisable
 * - Interface minimaliste sans carrousel
 */
document.addEventListener('DOMContentLoaded', function() {
    // Navigation fluide pour les liens d'ancre (améliore l'UX)
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            e.preventDefault();
            const target = document.querySelector(this.getAttribute('href'));
            if (target) {
                target.scrollIntoView({
                    behavior: 'smooth',
                    block: 'start'
                });
            }
        });
    });

    // Gestion des messages de downgrade Premium (nettoyage de l'interface)
    {% if just_downgraded %}
    // Actualisation forcée de l'interface après downgrade
    setTimeout(function() {
        // Suppression des éléments Premium résiduels
        const premiumElements = document.querySelectorAll('.premium-features-section, .premium-badge, .premium-nav-link');
        premiumElements.forEach(function(element) {
            element.style.display = 'none';
        });
        
        // Mise à jour des indicateurs de statut Premium vers Gratuit
        const premiumBadges = document.querySelectorAll('.badge.bg-warning');
        premiumBadges.forEach(function(badge) {
            badge.className = 'badge bg-secondary text-white';
            badge.innerHTML = '<i class="fas fa-user me-1"></i>Gratuit';
        });
        
        // Affichage prolongé du message de succès
        const successAlert = document.querySelector('.alert-success');
        if (successAlert) {
            successAlert.style.display = 'block';
        }
    }, 100); // Délai court pour laisser le DOM se charger
    {% endif %}
});
</script>
{% endblock %}
